{% block stylesheets %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.5/css/select2.min.css">
{% endblock %}
{{ form_start(form) }}
<div class="row">
    <div class="col-md-10">{{ form_row(form.name) }}</div>
    <div class="col-md-10">{{ form_row(form.projects) }}</div>
    <div class="col-md-10">{{ form_row(form.trainType) }}</div>

    <div class="content-type-train col-md-12 mt-4" id="select_locomotive">
        <h4>Select EVC : </h4>
        <img src="{{ asset('/build/img/trains/locomotive-select.svg') }}" alt="" class="col-md-10 img-type-train">
        <figure class="content-ertms col-md-10">
            <img src="{{ asset('/build/img/trains/ertms.svg') }}" alt="" class="ertms " id="ertms-loco-1">
            <img src="{{ asset('/build/img/trains/ertms.svg') }}" alt="" class="ertms " id="ertms-loco-2">

        </figure>
    </div>

    <div class="content-type-train col-md-12 mt-4" id="select_train">
        <h4>Select EVC : </h4>
        <img src="{{ asset('/build/img/trains/train-select.svg') }}" alt="" class="col-md-10  img-type-train">
        <figure class="content-ertms col-md-10">
            <img src="{{ asset('/build/img/trains/ertms.svg') }}" alt="" class="ertms" id="ertms-train-1">
            <img src="{{ asset('/build/img/trains/ertms.svg') }}" alt="" class="ertms" id="ertms-train-2">
            <img src="{{ asset('/build/img/trains/ertms.svg') }}" alt="" class="ertms " id="ertms-train-3">
        </figure>
    </div>

    <div class="col-md-10 mt-4" id="btn-choice-ertms">
        <div class="content-btn-train col-12">
            <p id="create-ertms-1">Add ERTMS</p>
            <p id="create-ertms-2">Add ERTMS</p>
        </div>

        <div class="col-md-12 mt-4" id="create-ertms-train-1">
            <div class="name-ertms">
                {{ form_start(form_ertms) }}
                {{ form_end(form_ertms) }}
            </div>
            {{ form_start(form_equipement) }}

                <div class="type-equipement row">
                    <div class="col-md-10">
                        {{ form_row(form_equipement.Type) }}
                    </div>
                    <div id="btn-create-type" class="col-md-2">
                        <p class=" btn-create-type">+</p>
                    </div>
                    <div id="create_type" class="col-md-12">
                        {{ form_start(form_type) }}
                        <div class="col-md-8">{{ form_row(form_type.name) }}</div>
                        {{ form_end(form_type) }}
                    </div>
                </div>
                <div class="type-equipement row">
                    <div class="col-md-10">
                        {{ form_row(form_equipement.Sous_type) }}
                    </div>
                    <div id="btn-create-soustype" class="col-md-2">
                        <p class=" btn-create-type">+</p>
                    </div>
                    <div id="create_soustype"  class="col-md-12">
                        {{ form_start(form_soustype) }}
                        <div class="col-md-8">{{ form_row(form_soustype.name) }}</div>
                        {{ form_end(form_soustype) }}
                    </div>
                </div>

            {{ form_end(form_equipement) }}
        </div>
        <div class="col-md-12 mt-4" id="create-ertms-train-2">
            add ertms 2
        </div>
    </div>


</div>
<button class="btn btn-primary mt-4">{{ button|default('Send') }}</button>

{{ form_end(form) }}



{% block javascripts %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script>

$(document).ready(function() {

    //Vidage des inputs aux changement de select
    // $('select[name="trains[projects]"], select[name="trains[trainType]"]').change(function(){
    //     $('input[name="trains[name]"]').val('');
    // });


                $('#create-ertms-1').hide();
                $('#create-ertms-2').hide();
                $('#create_soustype').hide();
                $('#create_type').hide();

    //Traitement du choix du type de train
    $('#trains_trainType')

        .change(function () {

            let current_choice = "", ertms_left = "", ertms_middle = "", ertms_right= "";

            $("#trains_trainType option:selected").each(function () {

                current_choice += $(this).text() + " ";

            });

            if (current_choice.trim() == 'Train') {
                $('#select_train').show();
                $('#select_locomotive').hide();

                $('#btn-create-type').click(function () {
                    $('#create_type').show();
                })
                $('#btn-create-soustype').click(function () {
                    $('#create_soustype').show();
                })

                $('#ertms-train-1').click(function () {
                    //l'ertms de gauche selectionner
                    $('#ertms-train-1').addClass("selected");
                    ertms_left = true;
                    ertms_middle = false;

                    $('#ertms-train-2').removeClass("selected");
                    $('#btn-choice-ertms').show();
                    $('#create-ertms-1').show();


                });
                $('#ertms-train-2').click(function () {
                    // l'ertms du milieu selectionner
                    $('#ertms-train-2').addClass("selected");
                    ertms_left = false;
                    ertms_right = false;
                    ertms_middle = true;

                    $('#ertms-train-1').removeClass("selected");
                    $('#ertms-train-3').removeClass("selected");
                    $('#btn-choice-ertms').show();
                    $('#create-ertms-1').show();
                    $('#create-ertms-2').hide();


                });
                $('#ertms-train-3').click(function () {
                    // l'ertms de droite selectionner
                    $('#ertms-train-3').addClass("selected");
                    ertms_right = true;
                    ertms_middle = false;
                    if(ertms_left== true && ertms_middle == false){
                        $('#create-ertms-1').show();
                        $('#create-ertms-2').show();
                    }else if (ertms_right == true && ertms_left== false){
                        $('#create-ertms-1').hide();
                        $('#create-ertms-2').show();
                    }

                    $('#ertms-train-2').removeClass("selected");
                    $('#btn-choice-ertms').show();


                });


                $('#trains_trainType').change(function () {$('#btn-choice-ertms').hide();});


            } else if (current_choice.trim() == 'Locomotive') {

                $('#select_locomotive').show();
                $('#select_train').hide();

                $('#ertms-loco-1').click(function () {
                    //l'ertms de gauche selectionner
                    $('#ertms-loco-1').addClass("selected");
                    $('#ertms-loco-2').removeClass("selected");
                    $('#btn-choice-ertms').show();


                });
                $('#ertms-loco-2').click(function () {
                    //l'ertms de droite selectionner
                    $('#ertms-loco-2').addClass("selected");
                    $('#ertms-loco-1').removeClass("selected");
                    $('#btn-choice-ertms').show();


                });
                $('#trains_trainType').change(function () {$('#btn-choice-ertms').hide();});



            }

        }).change();
})

        $('#trains_projects').change(function () {
            $('.content-type-train').hide();
            $('#trains_trainType').val('');
            $('#btn-choice-ertms').hide();


        })

    </script>
{% endblock %}
